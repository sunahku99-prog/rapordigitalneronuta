"use strict";(()=>{var e={};e.id=75,e.ids=[75],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},76162:e=>{e.exports=require("stream")},21764:e=>{e.exports=require("util")},74445:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>I,requestAsyncStorage:()=>w,routeModule:()=>x,serverHooks:()=>R,staticGenerationAsyncStorage:()=>A});var n={};r.r(n),r.d(n,{DELETE:()=>j,GET:()=>m,POST:()=>h,PUT:()=>f,runtime:()=>p});var s=r(49303),a=r(88716),i=r(60670),o=r(87070),u=r(53524),l=r(90455),d=r(97220);let p="nodejs",c=new u.PrismaClient;async function m(e){let t=(0,l.WX)(e.headers.get("authorization")||void 0);if(!t||!(0,l.Iq)([d.K.ADMIN],t.role))return o.NextResponse.json({message:"Unauthorized"},{status:401});let r=await c.subject.findMany();return o.NextResponse.json({subjects:r})}async function h(e){let t=(0,l.WX)(e.headers.get("authorization")||void 0);if(!t||!(0,l.Iq)([d.K.ADMIN],t.role))return o.NextResponse.json({message:"Unauthorized"},{status:401});let{code:r,name:n}=await e.json(),s=await c.subject.create({data:{code:r,name:n}});return o.NextResponse.json({subject:s})}async function f(e){let t=(0,l.WX)(e.headers.get("authorization")||void 0);if(!t||!(0,l.Iq)([d.K.ADMIN],t.role))return o.NextResponse.json({message:"Unauthorized"},{status:401});let{id:r,code:n,name:s}=await e.json(),a=await c.subject.update({where:{id:r},data:{code:n,name:s}});return o.NextResponse.json({subject:a})}async function j(e){let t=(0,l.WX)(e.headers.get("authorization")||void 0);if(!t||!(0,l.Iq)([d.K.ADMIN],t.role))return o.NextResponse.json({message:"Unauthorized"},{status:401});let{id:r}=await e.json();return await c.subject.delete({where:{id:r}}),o.NextResponse.json({ok:!0})}let x=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/subjects/route",pathname:"/api/admin/subjects",filename:"route",bundlePath:"app/api/admin/subjects/route"},resolvedPagePath:"D:\\rapor-digital\\rapor-digital\\app\\api\\admin\\subjects\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:w,staticGenerationAsyncStorage:A,serverHooks:R}=x,g="/api/admin/subjects/route";function I(){return(0,i.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:A})}},90455:(e,t,r)=>{r.d(t,{BN:()=>d,Iq:()=>m,VU:()=>l,WX:()=>c,cG:()=>p});var n=r(41482),s=r.n(n),a=r(42023),i=r.n(a);let o=new(r(53524)).PrismaClient,u=process.env.JWT_SECRET;async function l(e,t){let r=await o.user.findUnique({where:{email:e}});return r&&await i().compare(t,r.passwordHash)?r:null}async function d(e,t){let r=await o.student.findUnique({where:{nisn:e},include:{user:!0}});return r&&"SISWA"===r.user.role&&await i().compare(t,r.user.passwordHash)?r.user:null}function p(e){return s().sign({sub:e.id,role:e.role,name:e.name,email:e.email},u,{expiresIn:"8h"})}function c(e){if(!e)return null;let t=e.replace("Bearer ","");try{let e=s().verify(t,u);return{userId:Number(e.sub),role:e.role}}catch{return null}}function m(e,t){return t&&e.includes(t)}},97220:(e,t,r)=>{r.d(t,{K:()=>s});var n=r(53524);let s={ADMIN:n.Role.ADMIN,GURU:n.Role.GURU,WALI_KELAS:n.Role.WALI_KELAS,SISWA:n.Role.SISWA,ORANG_TUA:n.Role.ORANG_TUA}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,644],()=>r(74445));module.exports=n})();